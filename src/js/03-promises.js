/* –ú—ñ–∫—Ä–æ –ø—Ä–æ—Ü–µ—Å–∏ –º–∞—é—Ç—å –±—ñ–ª—å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- Promise; –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ - —ç—Ç–æ –æ–±—ä–µ–∫—Ç –≤ JavaScript, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ —Å—Ä–∞–∑—É, –ø–æ–∑–¥–Ω–µ–µ –∏–ª–∏ –Ω–∏–∫–æ–≥–¥–∞.
- Observer - –í JavaScript –ø–∞—Ç—Ç–µ—Ä–Ω Observer (–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å) —è–≤–ª—è–µ—Ç—Å—è –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–º —à–∞–±–ª–æ–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –æ–±—ä–µ–∫—Ç–µ –∏–ª–∏ –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –í —ç—Ç–æ–º —à–∞–±–ª–æ–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è "Subject" (–°—É–±—ä–µ–∫—Ç), –∏ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è "Observers" (–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏).

–ú–∞–∫—Ä–æ –ø—Ä–æ—Ü–µ—Å–∏ —ã –≤–æ–Ω–∏ –º–∞—é—Ç—å –º–µ–Ω—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- setTimeout;
- setInterval;
- setImmediate; - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –Ω–æ –¥–æ –Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π–Ω–æ–≥–æ —Ü–∏–∫–ª–∞.
- requestAnimationFrame - —ç—Ç–æ –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–π –∏ –¥—Ä—É–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ —Å –≤—ã—Å–æ–∫–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –∫–∞–¥—Ä–æ–≤. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é, –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–∞–¥—Ä–∞.
*/
//----–ü—Ä–∏–∫–ª–∞–¥:
// console.log('1');
// setTimeout(() => {console.log('2')}, 0);
// Promise.resolve('3').then(value => console.log(value));
// console.log('4');
// —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–æ–Ω—Å–æ–ª—ã –±—É–¥–µ 1 4 3 2

// const promise = new Promise((res, rej) => {
//   // —Å—Ç–∞—Ç—É—Å resolve (fulfilled) - –ø–µ—Ä–µ–¥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —É—Å–ø—ñ—à–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–º–∏—Å—É —Ç–∞ rejected - –Ω–µ—É—Å–ø—ñ—à–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
//   const random = Math.random();
//   console.log(random);
//   setTimeout(() => {
//     if (random > 0.5) {
//       res('Yes üòé');
//     } else {
//       rej('No üò¢');
//     }
//   }, 1000);
// });
// console.log(promise);

// //–¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø—Ä–æ–º–∏—Å–∞ –Ω–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –ª–∞–Ω—É—é–≥ .then, .catch, .finnaly

// promise // –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –ø–µ—Ä–µ–¥–∞–µ—Ç—å—Å—è –¥–≤—ñ –∫–∞–ª–±–µ–∫ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä—à–∞ –ø–µ—Ä–µ–¥–∞—î —É—Å–ø—ñ—à–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, —Ç–æ–±—Ç–æ –Ω–∞—à resolve; 2 - reject.
//   .then(data => {
//     console.log(data);
//     return data;
//   })
//   .then(resp => {
//     console.log(resp);
//   })
//   .catch(err => {
//     console.error(err);
//   });

//–ü—Ä–æ–º–∏—Å—ñ –≤—ñ–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –±–µ–∫–µ–Ω–¥. –°—Ç–≤–ª—Ä–∏–º–æ —è–∫–∏—Å—å –∑–∞–ø–∏—Ç:
// const resp = fetch('https://pokeapi.co/api/v2/pokemon/ditto');
// console.log(resp);

// resp
// .then(resp => resp.json())
// .then(data => console.log(data))
// .catch(err => console.log(err))

const form = document.querySelector('.form');
const firstDelay = document.querySelector('input[name=delay]');
const step = document.querySelector('input[name=step]');
const inputAmount = document.querySelector('input[name=amount]');

function createPromise(evt, position, delay) {
  evt.preventDefault();
  const promise = new Promise((res, rej) => {
    setTimeout(() => {
      const shouldResolve = Math.random() > 0.3;
      if (shouldResolve) {
        res({ position, delay });
      } else {
        rej({ position, delay });
      }
    }, delay);
  });
  return promise;
}

form.addEventListener('submit', evt => {
  evt.preventDefault();

  const firstDelay = Number(firstDelay.value);
  const delayStep = Number(step.value);
  const amount = Number(inputAmount.value);

  for (let i = 0; i < amount; i += 1) {
    createPromise(1 + i, firstDelay + i * delayStep)
      .then(({ position, delay }) => {
        console.log(`‚úÖ Fulfilled promise ${position} in ${delay}ms`);
      })
      .catch(({ position, delay }) => {
        console.log(`‚ùå Rejected promise ${position} in ${delay}ms`);
      });
  }
});

// 1. –Ñ —Ñ—É–Ω–∫—Ü—ñ—è createPromise(position, delay) - –í–ê–ñ–õ–ò–í–û - –≤–æ–Ω–∞ –ø–æ–≤–∏–Ω–Ω–∞ –í–ï–†–¢–ê–¢–ò –Ω–æ–≤–∏–π Promise
// 2. –£ —Ç—ñ–ª—ñ –ø—Ä–æ–º—ñ—Å—É, –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –∑–∞—Ç—Ä–∏–º–∫–∞ –≤–∏–∫–ª–∏–∫—É –∫–æ–ª–±–µ–∫—ñ–≤ resolve —ñ reject, —è–∫–∞ –∑–∞–¥–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä delay –∑ —Ñ—É–Ω–∫—Ü—ñ—ó (–ø—ñ–¥–∫–∞–∑–∫–∞ - setTimeout).
// 3. –î–æ —Ç—ñ–ª–∞ –ø—Ä–æ–º—ñ—Å—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏—á–µ–ø–∏—Ç–∏ –º–µ—Ç–æ–¥–∏ then —ñ catch, —è–∫—ñ –±—É–¥—É—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—è –∑ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∑ –∫–æ–ª–±–µ–∫—ñ–≤ resolve —Ç–∞ reject. –ê—Ä–≥—É–º–µ–Ω—Ç–æ–º —â–æ –≤ resolve, —â–æ –≤ reject –±—É–¥–µ –æ–±‚Äô—î–∫—Ç { position, delay }, –∞ then —ñ catch –±—É–¥—É—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Å–≤—ñ–π –∫–æ–ª–±–µ–∫ –∑ –ø–µ—Ä–µ–¥–∞–Ω–∏–º–∏ —ó–º –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ (—É –∑–∞–≤–¥–∞–Ω–Ω—ñ –∫–æ–ª–±–µ–∫–æ–º –º–µ—Ç–æ–¥—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ then i catch –±—É–¥–µ console.log)
// 4. –í—Å–µ, –≤–∏ –Ω–∞–ø–∏—Å–∞–ª–∏ –ø—Ä–æ–º—ñ—Å, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —è–∫–æ–≥–æ –º–∏ –æ—Ç—Ä–∏–º–∞—î–º–æ —á–µ—Ä–µ–∑ delay —á–∞—Å—É, —Ü–µ –≥–æ—Ç–æ–≤–æ.
// 5. –î–∞–ª—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–¥—É–º–∞—Ç–∏, —è–∫ –Ω–∞–º –≤–∏–∑–∏–≤–∞—Ç–∏ —Ü–µ–π –ø—Ä–æ–º—ñ—Å –ø–æ—Ç—Ä—ñ–±–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑—ñ–≤.
// 6. –ü–æ–¥—É–º–∞–ª–∏, –ø—Ä–∏–¥—É–º–∞–ª–∏ - –¥–æ–±—Ä–µ, –ø–æ—Ç—ñ–º, –Ω–∞ –∫–æ–∂–Ω—ñ–π —ñ—Ç–µ—Ä–∞—Ü—ñ—ó –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó createPromise(position, delay), –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞–≤–∞—Ç–∏ +1 –¥–æ position, —ñ +delay –¥–æ delay –∑ –ø–æ–ª—è ‚ÄúDelay step‚Äù.
// 7. –ü–æ—Ç—ñ–º, –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏ —â–µ —É–º–æ–≤—É –∑ first delay, –∞–ª–µ —Ç—É—Ç –±—É–∫–≤–∞–ª—å–Ω–æ –æ–¥–∏–Ω if –Ω–∞ 3 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥—É.
